generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model aboutapp {
  id            String   @id
  titleEn       String?
  titleAr       String?
  descriptionEn String?  @db.Text
  descriptionAr String?  @db.Text
  version       String?
  imageEn       String?
  imageAr       String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime
}

model activitylog {
  id         String   @id
  userId     String
  action     String
  entityType String
  entityId   String
  createdAt  DateTime @default(now())
  user       user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "ActivityLog_userId_fkey")

  @@index([action], map: "ActivityLog_action_idx")
  @@index([createdAt], map: "ActivityLog_createdAt_idx")
  @@index([entityType, entityId], map: "ActivityLog_entityType_entityId_idx")
  @@index([userId], map: "ActivityLog_userId_idx")
}

model cart {
  id        String     @id
  userId    String     @unique(map: "Cart_userId_key")
  createdAt DateTime   @default(now())
  updatedAt DateTime
  user      user       @relation(fields: [userId], references: [id], onDelete: Cascade, map: "Cart_userId_fkey")
  cartitem  cartitem[]

  @@index([userId], map: "Cart_userId_idx")
}

model cartitem {
  id        String   @id
  cartId    String
  productId String
  quantity  Int      @default(1)
  options   String?  @db.LongText
  createdAt DateTime @default(now())
  updatedAt DateTime
  cart      cart     @relation(fields: [cartId], references: [id], onDelete: Cascade, map: "CartItem_cartId_fkey")
  product   product  @relation(fields: [productId], references: [id], onDelete: Cascade, map: "CartItem_productId_fkey")

  @@unique([cartId, productId], map: "CartItem_cartId_productId_key")
  @@index([cartId], map: "CartItem_cartId_idx")
  @@index([productId], map: "CartItem_productId_idx")
}

model category {
  id          String        @id
  nameAr      String
  nameEn      String
  imageUrl    String?
  isActive    Boolean       @default(true)
  restaurant  restaurant[]
  subcategory subcategory[]

  @@index([isActive], map: "Category_isActive_idx")
}

model chat {
  id              String            @id
  orderType       String
  foodOrderId     String?           @unique(map: "Chat_foodOrderId_key")
  shippingOrderId String?           @unique(map: "Chat_shippingOrderId_key")
  createdAt       DateTime          @default(now())
  foodorder       foodorder?        @relation(fields: [foodOrderId], references: [id], onDelete: Cascade, map: "Chat_foodOrderId_fkey")
  shippingorder   shippingorder?    @relation(fields: [shippingOrderId], references: [id], onDelete: Cascade, map: "Chat_shippingOrderId_fkey")
  chatmessage     chatmessage[]
  chatparticipant chatparticipant[]

  @@index([orderType], map: "Chat_orderType_idx")
}

model chatmessage {
  id        String   @id
  chatId    String
  senderId  String
  message   String   @db.Text
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())
  chat      chat     @relation(fields: [chatId], references: [id], onDelete: Cascade, map: "ChatMessage_chatId_fkey")
  user      user     @relation(fields: [senderId], references: [id], onDelete: Cascade, map: "ChatMessage_senderId_fkey")

  @@index([chatId], map: "ChatMessage_chatId_idx")
  @@index([createdAt], map: "ChatMessage_createdAt_idx")
  @@index([senderId], map: "ChatMessage_senderId_idx")
}

model chatparticipant {
  id     String @id
  chatId String
  userId String
  role   String
  chat   chat   @relation(fields: [chatId], references: [id], onDelete: Cascade, map: "ChatParticipant_chatId_fkey")
  user   user   @relation(fields: [userId], references: [id], onDelete: Cascade, map: "ChatParticipant_userId_fkey")

  @@unique([chatId, userId], map: "ChatParticipant_chatId_userId_key")
  @@index([chatId], map: "ChatParticipant_chatId_idx")
  @@index([userId], map: "ChatParticipant_userId_idx")
}

model coupon {
  id             String        @id
  restaurantId   String
  code           String        @unique(map: "Coupon_code_key")
  discountType   String
  discountValue  Float
  minOrderAmount Float
  usageLimit     Int
  usedCount      Int           @default(0)
  startAt        DateTime
  endAt          DateTime
  isActive       Boolean       @default(true)
  restaurant     restaurant    @relation(fields: [restaurantId], references: [id], onDelete: Cascade, map: "Coupon_restaurantId_fkey")
  couponusage    couponusage[]

  @@index([code], map: "Coupon_code_idx")
  @@index([isActive], map: "Coupon_isActive_idx")
  @@index([restaurantId], map: "Coupon_restaurantId_idx")
}

model couponusage {
  id        String    @id
  couponId  String
  userId    String
  orderId   String
  usedAt    DateTime  @default(now())
  coupon    coupon    @relation(fields: [couponId], references: [id], onDelete: Cascade, map: "CouponUsage_couponId_fkey")
  foodorder foodorder @relation(fields: [orderId], references: [id], onDelete: Cascade, map: "CouponUsage_orderId_fkey")
  user      user      @relation(fields: [userId], references: [id], onDelete: Cascade, map: "CouponUsage_userId_fkey")

  @@unique([couponId, userId, orderId], map: "CouponUsage_couponId_userId_orderId_key")
  @@index([couponId], map: "CouponUsage_couponId_idx")
  @@index([orderId], map: "CouponUsage_orderId_fkey")
  @@index([userId], map: "CouponUsage_userId_idx")
}

model deliverydriver {
  id               String          @id
  userId           String          @unique(map: "DeliveryDriver_userId_key")
  restaurantId     String?
  isPlatformDriver Boolean
  isOnline         Boolean         @default(false)
  rating           Float           @default(0)
  restaurant       restaurant?     @relation(fields: [restaurantId], references: [id], map: "DeliveryDriver_restaurantId_fkey")
  user             user            @relation(fields: [userId], references: [id], onDelete: Cascade, map: "DeliveryDriver_userId_fkey")
  driverlocation   driverlocation?
  foodorder        foodorder[]

  @@index([isOnline], map: "DeliveryDriver_isOnline_idx")
  @@index([restaurantId], map: "DeliveryDriver_restaurantId_idx")
  @@index([userId], map: "DeliveryDriver_userId_idx")
}

model deliverytimeestimate {
  id           String     @id
  restaurantId String     @unique(map: "DeliveryTimeEstimate_restaurantId_key")
  baseTime     Int
  perKmTime    Int?
  busyTimeAdd  Int?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime
  restaurant   restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade, map: "DeliveryTimeEstimate_restaurantId_fkey")

  @@index([restaurantId], map: "DeliveryTimeEstimate_restaurantId_idx")
}

model deliveryzone {
  id           String     @id
  restaurantId String
  name         String
  coordinates  String     @db.LongText
  isActive     Boolean    @default(true)
  fee          Float?
  minOrder     Float?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime
  restaurant   restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade, map: "DeliveryZone_restaurantId_fkey")

  @@index([isActive], map: "DeliveryZone_isActive_idx")
  @@index([restaurantId], map: "DeliveryZone_restaurantId_idx")
}

model driverlocation {
  id             String         @id
  driverId       String         @unique(map: "DriverLocation_driverId_key")
  lat            Float
  lng            Float
  heading        Float?
  speed          Float?
  updatedAt      DateTime
  deliverydriver deliverydriver @relation(fields: [driverId], references: [id], onDelete: Cascade, map: "DriverLocation_driverId_fkey")

  @@index([driverId], map: "DriverLocation_driverId_idx")
  @@index([updatedAt], map: "DriverLocation_updatedAt_idx")
}

model favoriteproduct {
  id        String   @id
  userId    String
  productId String
  createdAt DateTime @default(now())
  product   product  @relation(fields: [productId], references: [id], onDelete: Cascade, map: "FavoriteProduct_productId_fkey")
  user      user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "FavoriteProduct_userId_fkey")

  @@unique([userId, productId], map: "FavoriteProduct_userId_productId_key")
  @@index([productId], map: "FavoriteProduct_productId_idx")
  @@index([userId], map: "FavoriteProduct_userId_idx")
}

model favoriterestaurant {
  id           String     @id
  userId       String
  restaurantId String
  createdAt    DateTime   @default(now())
  restaurant   restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade, map: "FavoriteRestaurant_restaurantId_fkey")
  user         user       @relation(fields: [userId], references: [id], onDelete: Cascade, map: "FavoriteRestaurant_userId_fkey")

  @@unique([userId, restaurantId], map: "FavoriteRestaurant_userId_restaurantId_key")
  @@index([restaurantId], map: "FavoriteRestaurant_restaurantId_idx")
  @@index([userId], map: "FavoriteRestaurant_userId_idx")
}

model foodorder {
  id                 String               @id
  userId             String
  restaurantId       String
  driverId           String?
  addressId          String
  status             String
  totalPrice         Float
  tip                Float?
  notes              String?              @db.Text
  cancelledAt        DateTime?
  cancelReason       String?
  cancelledBy        String?
  createdAt          DateTime             @default(now())
  chat               chat?
  couponusage        couponusage[]
  deliverydriver     deliverydriver?      @relation(fields: [driverId], references: [id], map: "FoodOrder_driverId_fkey")
  restaurant         restaurant           @relation(fields: [restaurantId], references: [id], map: "FoodOrder_restaurantId_fkey")
  user               user                 @relation(fields: [userId], references: [id], map: "FoodOrder_userId_fkey")
  foodorderitem      foodorderitem[]
  notification       notification[]
  orderstatushistory orderstatushistory[]
  pointstransaction  pointstransaction[]

  @@index([cancelledAt], map: "FoodOrder_cancelledAt_idx")
  @@index([createdAt], map: "FoodOrder_createdAt_idx")
  @@index([driverId], map: "FoodOrder_driverId_idx")
  @@index([restaurantId], map: "FoodOrder_restaurantId_idx")
  @@index([status], map: "FoodOrder_status_idx")
  @@index([userId], map: "FoodOrder_userId_idx")
}

model foodorderitem {
  id          String    @id
  foodOrderId String
  productId   String
  quantity    Int
  price       Float
  foodorder   foodorder @relation(fields: [foodOrderId], references: [id], onDelete: Cascade, map: "FoodOrderItem_foodOrderId_fkey")
  product     product   @relation(fields: [productId], references: [id], map: "FoodOrderItem_productId_fkey")

  @@index([foodOrderId], map: "FoodOrderItem_foodOrderId_idx")
  @@index([productId], map: "FoodOrderItem_productId_idx")
}

model notification {
  id        String     @id
  userId    String
  type      String
  title     String
  message   String     @db.Text
  data      String?    @db.LongText
  isRead    Boolean    @default(false)
  orderId   String?
  createdAt DateTime   @default(now())
  foodorder foodorder? @relation(fields: [orderId], references: [id], map: "Notification_orderId_fkey")
  user      user       @relation(fields: [userId], references: [id], onDelete: Cascade, map: "Notification_userId_fkey")

  @@index([createdAt], map: "Notification_createdAt_idx")
  @@index([isRead], map: "Notification_isRead_idx")
  @@index([orderId], map: "Notification_orderId_idx")
  @@index([type], map: "Notification_type_idx")
  @@index([userId], map: "Notification_userId_idx")
}

model onboardingscreen {
  id            String   @id
  title         String
  titleAr       String?
  description   String   @db.Text
  descriptionAr String?  @db.Text
  image         String
  sortOrder     Int      @default(0)
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime

  @@index([isActive], map: "OnboardingScreen_isActive_idx")
  @@index([sortOrder], map: "OnboardingScreen_sortOrder_idx")
}

model orderstatushistory {
  id         String    @id
  orderId    String
  status     String
  userId     String?
  notes      String?   @db.Text
  expectedAt DateTime?
  createdAt  DateTime  @default(now())
  foodorder  foodorder @relation(fields: [orderId], references: [id], onDelete: Cascade, map: "OrderStatusHistory_orderId_fkey")
  user       user?     @relation(fields: [userId], references: [id], map: "OrderStatusHistory_userId_fkey")

  @@index([createdAt], map: "OrderStatusHistory_createdAt_idx")
  @@index([orderId], map: "OrderStatusHistory_orderId_idx")
  @@index([status], map: "OrderStatusHistory_status_idx")
  @@index([userId], map: "OrderStatusHistory_userId_fkey")
}

model payment {
  id              String   @id
  userId          String
  orderType       String
  orderId         String
  amount          Float
  method          String
  status          String
  paymentMethodId String?
  createdAt       DateTime @default(now())
  user            user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "Payment_userId_fkey")

  @@index([orderType, orderId], map: "Payment_orderType_orderId_idx")
  @@index([paymentMethodId], map: "Payment_paymentMethodId_idx")
  @@index([status], map: "Payment_status_idx")
  @@index([userId], map: "Payment_userId_idx")
}

model paymentmethod {
  id          String   @id
  userId      String
  type        String
  provider    String?
  last4       String?
  expiryMonth Int?
  expiryYear  Int?
  isDefault   Boolean  @default(false)
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime
  user        user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "PaymentMethod_userId_fkey")

  @@index([isDefault], map: "PaymentMethod_isDefault_idx")
  @@index([type], map: "PaymentMethod_type_idx")
  @@index([userId], map: "PaymentMethod_userId_idx")
}

model pointstransaction {
  id          String     @id
  userId      String
  orderId     String?
  points      Int
  type        String
  description String?    @db.Text
  createdAt   DateTime   @default(now())
  foodorder   foodorder? @relation(fields: [orderId], references: [id], map: "PointsTransaction_orderId_fkey")
  user        user       @relation(fields: [userId], references: [id], onDelete: Cascade, map: "PointsTransaction_userId_fkey")

  @@index([createdAt], map: "PointsTransaction_createdAt_idx")
  @@index([orderId], map: "PointsTransaction_orderId_idx")
  @@index([type], map: "PointsTransaction_type_idx")
  @@index([userId], map: "PointsTransaction_userId_idx")
}

model privacypolicy {
  id        String   @id
  contentEn String   @db.Text
  contentAr String   @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model product {
  id               String             @id
  restaurantId     String
  subcategoryId    String
  nameAr           String
  nameEn           String
  descriptionAr    String?            @db.Text
  descriptionEn    String?            @db.Text
  price            Float
  calories         Int?
  cookingTime      Int?
  nutritionInfo    String?            @db.LongText
  rating           Float              @default(0)
  isAvailable      Boolean            @default(true)
  cartitem         cartitem[]
  favoriteproduct  favoriteproduct[]
  foodorderitem    foodorderitem[]
  restaurant       restaurant         @relation(fields: [restaurantId], references: [id], onDelete: Cascade, map: "Product_restaurantId_fkey")
  subcategory      subcategory        @relation(fields: [subcategoryId], references: [id], map: "Product_subcategoryId_fkey")
  productimage     productimage[]
  productoption    productoption[]
  promotionproduct promotionproduct[]

  @@index([isAvailable], map: "Product_isAvailable_idx")
  @@index([restaurantId], map: "Product_restaurantId_idx")
  @@index([subcategoryId], map: "Product_subcategoryId_idx")
}

model productimage {
  id        String   @id
  productId String
  imageUrl  String
  isPrimary Boolean  @default(false)
  sortOrder Int      @default(0)
  createdAt DateTime @default(now())
  product   product  @relation(fields: [productId], references: [id], onDelete: Cascade, map: "ProductImage_productId_fkey")

  @@index([isPrimary], map: "ProductImage_isPrimary_idx")
  @@index([productId], map: "ProductImage_productId_idx")
}

model productoption {
  id        String  @id
  productId String
  nameAr    String
  nameEn    String
  price     Float
  isActive  Boolean @default(true)
  product   product @relation(fields: [productId], references: [id], onDelete: Cascade, map: "ProductOption_productId_fkey")

  @@index([productId], map: "ProductOption_productId_idx")
}

model promotion {
  id               String             @id
  restaurantId     String
  type             String
  discountType     String
  discountValue    Float
  startAt          DateTime
  endAt            DateTime
  isActive         Boolean            @default(true)
  createdAt        DateTime           @default(now())
  restaurant       restaurant         @relation(fields: [restaurantId], references: [id], onDelete: Cascade, map: "Promotion_restaurantId_fkey")
  promotionproduct promotionproduct[]

  @@index([isActive], map: "Promotion_isActive_idx")
  @@index([restaurantId], map: "Promotion_restaurantId_idx")
  @@index([startAt, endAt], map: "Promotion_startAt_endAt_idx")
}

model promotionproduct {
  id          String    @id
  promotionId String
  productId   String
  product     product   @relation(fields: [productId], references: [id], onDelete: Cascade, map: "PromotionProduct_productId_fkey")
  promotion   promotion @relation(fields: [promotionId], references: [id], onDelete: Cascade, map: "PromotionProduct_promotionId_fkey")

  @@unique([promotionId, productId], map: "PromotionProduct_promotionId_productId_key")
  @@index([productId], map: "PromotionProduct_productId_fkey")
}

model rating {
  id         String   @id
  userId     String
  targetType String
  targetId   String
  rating     Int
  comment    String?  @db.Text
  createdAt  DateTime @default(now())
  user       user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "Rating_userId_fkey")

  @@index([rating], map: "Rating_rating_idx")
  @@index([targetType, targetId], map: "Rating_targetType_targetId_idx")
  @@index([userId], map: "Rating_userId_idx")
}

model restaurant {
  id                            String                @id
  categoryId                    String
  ownerId                       String
  adminId                       String?               @unique(map: "Restaurant_adminId_key")
  imageUrl                      String?
  nameAr                        String
  nameEn                        String
  descriptionAr                 String?               @db.Text
  descriptionEn                 String?               @db.Text
  phone                         String
  deliveryType                  String
  rating                        Float                 @default(0)
  isActive                      Boolean               @default(true)
  createdAt                     DateTime              @default(now())
  coupon                        coupon[]
  deliverydriver                deliverydriver[]
  deliverytimeestimate          deliverytimeestimate?
  deliveryzone                  deliveryzone[]
  favoriterestaurant            favoriterestaurant[]
  foodorder                     foodorder[]
  product                       product[]
  promotion                     promotion[]
  user_restaurant_adminIdTouser user?                 @relation("restaurant_adminIdTouser", fields: [adminId], references: [id], map: "Restaurant_adminId_fkey")
  category                      category              @relation(fields: [categoryId], references: [id], map: "Restaurant_categoryId_fkey")
  user_restaurant_ownerIdTouser user                  @relation("restaurant_ownerIdTouser", fields: [ownerId], references: [id], map: "Restaurant_ownerId_fkey")
  restauranthours               restauranthours[]

  @@index([categoryId], map: "Restaurant_categoryId_idx")
  @@index([isActive], map: "Restaurant_isActive_idx")
  @@index([ownerId], map: "Restaurant_ownerId_idx")
}

model restauranthours {
  id           String     @id
  restaurantId String
  dayOfWeek    Int
  openTime     String
  closeTime    String
  isOpen       Boolean    @default(true)
  createdAt    DateTime   @default(now())
  updatedAt    DateTime
  restaurant   restaurant @relation(fields: [restaurantId], references: [id], onDelete: Cascade, map: "RestaurantHours_restaurantId_fkey")

  @@unique([restaurantId, dayOfWeek], map: "RestaurantHours_restaurantId_dayOfWeek_key")
  @@index([dayOfWeek], map: "RestaurantHours_dayOfWeek_idx")
  @@index([restaurantId], map: "RestaurantHours_restaurantId_idx")
}

model role {
  id       Int        @id @default(autoincrement())
  name     String     @unique(map: "Role_name_key")
  userrole userrole[]

  @@index([name], map: "Role_name_idx")
}

model shippingagent {
  id            String          @id
  userId        String          @unique(map: "ShippingAgent_userId_key")
  vehicleType   String
  isActive      Boolean         @default(true)
  rating        Float           @default(0)
  user          user            @relation(fields: [userId], references: [id], onDelete: Cascade, map: "ShippingAgent_userId_fkey")
  shippingorder shippingorder[]

  @@index([isActive], map: "ShippingAgent_isActive_idx")
  @@index([userId], map: "ShippingAgent_userId_idx")
}

model shippingorder {
  id                 String               @id
  userId             String
  agentId            String?
  pickupLat          Float
  pickupLng          Float
  deliveryLat        Float
  deliveryLng        Float
  status             String
  expectedCost       Float
  finalCost          Float?
  createdAt          DateTime             @default(now())
  chat               chat?
  shippingagent      shippingagent?       @relation(fields: [agentId], references: [id], map: "ShippingOrder_agentId_fkey")
  user               user                 @relation(fields: [userId], references: [id], map: "ShippingOrder_userId_fkey")
  shippingorderimage shippingorderimage[]

  @@index([agentId], map: "ShippingOrder_agentId_idx")
  @@index([createdAt], map: "ShippingOrder_createdAt_idx")
  @@index([status], map: "ShippingOrder_status_idx")
  @@index([userId], map: "ShippingOrder_userId_idx")
}

model shippingorderimage {
  id              String        @id
  shippingOrderId String
  imageUrl        String
  shippingorder   shippingorder @relation(fields: [shippingOrderId], references: [id], onDelete: Cascade, map: "ShippingOrderImage_shippingOrderId_fkey")

  @@index([shippingOrderId], map: "ShippingOrderImage_shippingOrderId_idx")
}

model splashscreen {
  id        String   @id
  image     String
  duration  Int      @default(3000)
  sortOrder Int      @default(0)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime

  @@index([isActive], map: "SplashScreen_isActive_idx")
  @@index([sortOrder], map: "SplashScreen_sortOrder_idx")
}

model subcategory {
  id         String    @id
  categoryId String
  nameAr     String
  nameEn     String
  imageUrl   String?
  sortOrder  Int       @default(0)
  isActive   Boolean   @default(true)
  product    product[]
  category   category  @relation(fields: [categoryId], references: [id], onDelete: Cascade, map: "Subcategory_categoryId_fkey")

  @@index([categoryId], map: "Subcategory_categoryId_idx")
}

model supportticket {
  id        String   @id
  userId    String
  orderType String
  orderId   String
  status    String
  message   String   @db.Text
  createdAt DateTime @default(now())
  user      user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "SupportTicket_userId_fkey")

  @@index([createdAt], map: "SupportTicket_createdAt_idx")
  @@index([status], map: "SupportTicket_status_idx")
  @@index([userId], map: "SupportTicket_userId_idx")
}

model termsofservice {
  id        String   @id
  contentEn String   @db.Text
  contentAr String   @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime
}

model user {
  id                                  String               @id
  name                                String
  phone                               String               @unique(map: "User_phone_key")
  email                               String               @unique(map: "User_email_key")
  password                            String
  language                            String?
  isActive                            Boolean              @default(true)
  avatar                              String?
  createdAt                           DateTime             @default(now())
  activitylog                         activitylog[]
  cart                                cart?
  chatmessage                         chatmessage[]
  chatparticipant                     chatparticipant[]
  couponusage                         couponusage[]
  deliverydriver                      deliverydriver?
  favoriteproduct                     favoriteproduct[]
  favoriterestaurant                  favoriterestaurant[]
  foodorder                           foodorder[]
  notification                        notification[]
  orderstatushistory                  orderstatushistory[]
  payment                             payment[]
  paymentmethod                       paymentmethod[]
  pointstransaction                   pointstransaction[]
  rating                              rating[]
  restaurant_restaurant_adminIdTouser restaurant?          @relation("restaurant_adminIdTouser")
  restaurant_restaurant_ownerIdTouser restaurant[]         @relation("restaurant_ownerIdTouser")
  shippingagent                       shippingagent?
  shippingorder                       shippingorder[]
  supportticket                       supportticket[]
  useraddress                         useraddress[]
  userpoints                          userpoints?
  userrole                            userrole[]

  @@index([email], map: "User_email_idx")
  @@index([phone], map: "User_phone_idx")
}

model useraddress {
  id        String   @id
  userId    String
  type      String?
  label     String?
  address   String
  lat       Float
  lng       Float
  phone     String?
  building  String?
  floor     String?
  apartment String?
  notes     String?  @db.Text
  isDefault Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime
  user      user     @relation(fields: [userId], references: [id], onDelete: Cascade, map: "UserAddress_userId_fkey")

  @@index([isDefault], map: "UserAddress_isDefault_idx")
  @@index([type], map: "UserAddress_type_idx")
  @@index([userId], map: "UserAddress_userId_idx")
}

model userpoints {
  id           String    @id
  userId       String    @unique(map: "UserPoints_userId_key")
  points       Int       @default(0)
  earnedPoints Int       @default(0)
  usedPoints   Int       @default(0)
  expiresAt    DateTime?
  createdAt    DateTime  @default(now())
  updatedAt    DateTime
  user         user      @relation(fields: [userId], references: [id], onDelete: Cascade, map: "UserPoints_userId_fkey")

  @@index([expiresAt], map: "UserPoints_expiresAt_idx")
  @@index([userId], map: "UserPoints_userId_idx")
}

model userrole {
  userId String
  roleId Int
  role   role   @relation(fields: [roleId], references: [id], onDelete: Cascade, map: "UserRole_roleId_fkey")
  user   user   @relation(fields: [userId], references: [id], onDelete: Cascade, map: "UserRole_userId_fkey")

  @@id([userId, roleId])
  @@index([roleId], map: "UserRole_roleId_fkey")
}
